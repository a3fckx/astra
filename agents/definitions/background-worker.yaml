name: Astra Background Worker
# Model: Can be overridden by ASTRA_MODEL environment variable
# This is the fallback if ASTRA_MODEL is not set
model: openrouter/anthropic/claude-4.5-sonnet
project: astra
about: >
  Background agent responsible for generating daily horoscopes,
  enriching user preferences, and performing scheduled data analysis
  for the Astra platform.

instructions: |
  You are a background processing agent for the Astra platform.
  
  Your responsibilities:
  - Generate personalized daily horoscopes based on user birth data
  - Analyze conversation patterns to enrich user preferences
  - Update user preference documents with discovered insights
  - Maintain high-quality, consistent metadata following the Astra schema
  - Write structured, concise outputs suitable for long-term storage
  
  Always write outputs following the Astra metadata schema:
  - type: profile | preferences | horoscope | notes | analysis
  - scope: frontline | background
  - shared: true (to allow cross-agent access)
  - updated_by: your task_id
  - timestamp_iso: current ISO timestamp
  
  Be consistent, thorough, and culturally sensitive in your outputs.
  Focus on actionable insights and practical guidance.

metadata:
  type: background
  role: task_executor
  version: "1.0"

default_settings:
  temperature: 0.4
  max_tokens: 2000
  top_p: 0.9
  frequency_penalty: 0.0
  presence_penalty: 0.0

# Tools for background worker to access and modify user documents
tools:
  - name: search_user_docs
    description: Search user documents for profile data, preferences, and past information
    type: system
    system:
      resource: user
      subresource: doc
      operation: search

  - name: list_user_docs
    description: List all documents for a user with optional metadata filtering
    type: system
    system:
      resource: user
      subresource: doc
      operation: list

  - name: get_user_doc
    description: Get a specific user document by ID
    type: system
    system:
      resource: user
      subresource: doc
      operation: get

  - name: create_user_doc
    description: Create a new document for a user (for storing generated content)
    type: system
    system:
      resource: user
      subresource: doc
      operation: create

  - name: update_user_doc
    description: Update an existing user document
    type: system
    system:
      resource: user
      subresource: doc
      operation: update

  - name: memory_store
    description: Access Astra's shared memory surface via the Memory Store MCP server
    type: integration
    integration:
      provider: mcp
      method: list_tools
      setup:
        transport: command
        command: npx
        args:
          - mcp-remote
          - https://beta.memory.store/mcp/?token={MEMORY_STORE_MCP_TOKEN}
